<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>ruby学习笔记 | マクロス</title><link rel=canonical href=https://www.takuzen.me/posts/2016-12-08-ruby-notes/><meta name=description content="勉強中"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="ruby学习笔记"><meta property="og:description" content="regular expressions =~是用于正则表达式的匹配操作符。返回匹配到的字符串位置或nil。
&#34;abcdef&#34; =~ /d/ # return 3 &#34;aaaaaa&#34; =~ /d/ # return nil !和? The exclamation point (!, sometimes pronounced aloud as &ldquo;bang!&rdquo;) indicates something potentially destructive, that is to say, something that can change the value of what it touches.
ruby> s1 = &#34;forth&#34; &#34;forth&#34; ruby> s1.chop! # This changes s1. &#34;fort&#34; ruby> s2 = s1.chop # This puts a changed copy in s2, &#34;for&#34; ruby> s1 # ."><meta property="og:type" content="article"><meta property="og:url" content="https://www.takuzen.me/posts/2016-12-08-ruby-notes/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-12-08T22:54:49+00:00"><meta property="article:modified_time" content="2016-12-08T22:54:49+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ruby学习笔记"><meta name=twitter:description content="regular expressions =~是用于正则表达式的匹配操作符。返回匹配到的字符串位置或nil。
&#34;abcdef&#34; =~ /d/ # return 3 &#34;aaaaaa&#34; =~ /d/ # return nil !和? The exclamation point (!, sometimes pronounced aloud as &ldquo;bang!&rdquo;) indicates something potentially destructive, that is to say, something that can change the value of what it touches.
ruby> s1 = &#34;forth&#34; &#34;forth&#34; ruby> s1.chop! # This changes s1. &#34;fort&#34; ruby> s2 = s1.chop # This puts a changed copy in s2, &#34;for&#34; ruby> s1 # ."><link rel=stylesheet href=https://www.takuzen.me/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://www.takuzen.me/images/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-83047470-2","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://www.takuzen.me/posts/2016-11-29-iptables-usage/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://www.takuzen.me/posts/2017-01-11-php-lambada/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&text=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&title=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&is_video=false&description=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0&body=Check out this article: https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&title=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&title=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&name=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0&description=regular%20expressions%20%3d~%e6%98%af%e7%94%a8%e4%ba%8e%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f%e7%9a%84%e5%8c%b9%e9%85%8d%e6%93%8d%e4%bd%9c%e7%ac%a6%e3%80%82%e8%bf%94%e5%9b%9e%e5%8c%b9%e9%85%8d%e5%88%b0%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e4%bd%8d%e7%bd%ae%e6%88%96nil%e3%80%82%0a%26%2334%3babcdef%26%2334%3b%20%3d~%20%2fd%2f%20%23%20return%203%20%26%2334%3baaaaaa%26%2334%3b%20%3d~%20%2fd%2f%20%23%20return%20nil%20%21%e5%92%8c%3f%20The%20exclamation%20point%20%28%21%2c%20sometimes%20pronounced%20aloud%20as%20%26ldquo%3bbang%21%26rdquo%3b%29%20indicates%20something%20potentially%20destructive%2c%20that%20is%20to%20say%2c%20something%20that%20can%20change%20the%20value%20of%20what%20it%20touches.%0aruby%26gt%3b%20s1%20%3d%20%26%2334%3bforth%26%2334%3b%20%26%2334%3bforth%26%2334%3b%20ruby%26gt%3b%20s1.chop%21%20%23%20This%20changes%20s1.%20%26%2334%3bfort%26%2334%3b%20ruby%26gt%3b%20s2%20%3d%20s1.chop%20%23%20This%20puts%20a%20changed%20copy%20in%20s2%2c%20%26%2334%3bfor%26%2334%3b%20ruby%26gt%3b%20s1%20%23%20." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&t=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#regular-expressions>regular expressions</a></li><li><a href=#和>!和?</a></li><li><a href=#四种内部中断循环的方式>四种内部中断循环的方式</a></li><li><a href=#迭代器-iterator>迭代器 iterator</a><ul><li><a href=#yield>yield</a></li></ul></li><li><a href=#class>class</a><ul><li><a href=#继承>继承</a></li><li><a href=#初始化构造函数>初始化（构造函数）</a></li></ul></li><li><a href=#variables>variables</a><ul><li><a href=#全局变量>全局变量</a></li><li><a href=#实例变量>实例变量</a></li><li><a href=#常量>常量</a></li></ul></li><li><a href=#访问器accessor>访问器(accessor)</a><ul><li><a href=#inspect方法>inspect方法</a></li><li><a href=#shortcuts>shortcuts</a></li></ul></li><li><a href=#注释>注释</a></li><li><a href=#dynamic-dispatch>Dynamic Dispatch</a></li><li><a href=#mixins>Mixins</a><ul><li><a href=#lookup-rulres>Lookup rulres</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">ruby学习笔记</h1><div class=meta><div class=postdate><time datetime="2016-12-08 22:54:49 +0000 UTC" itemprop=datePublished>2016-12-08</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/ruby rel=tag>ruby</a></div></div></header><div class=content itemprop=articleBody><h2 id=regular-expressions>regular expressions</h2><p><code>=~</code>是用于正则表达式的匹配操作符。返回匹配到的字符串位置或nil。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#e6db74>&#34;abcdef&#34;</span> <span style=color:#f92672>=~</span> <span style=color:#e6db74>/d/</span> <span style=color:#75715e># return 3</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;aaaaaa&#34;</span> <span style=color:#f92672>=~</span> <span style=color:#e6db74>/d/</span> <span style=color:#75715e># return nil</span>
</span></span></code></pre></div><h2 id=和>!和?</h2><p>The exclamation point (!, sometimes pronounced aloud as &ldquo;bang!&rdquo;) indicates something potentially destructive, that is to say, something that can change the value of what it touches.</p><pre tabindex=0><code>ruby&gt; s1 = &#34;forth&#34;
  &#34;forth&#34;
ruby&gt; s1.chop!       # This changes s1.
  &#34;fort&#34;
ruby&gt; s2 = s1.chop   # This puts a changed copy in s2,
  &#34;for&#34;
ruby&gt; s1             # ... without disturbing s1.
  &#34;fort&#34;
</code></pre><p>You&rsquo;ll also sometimes see chomp and chomp! used. These are more selective: the end of a string gets bit off only if it happens to be a newline.</p><p>The other method naming convention is the question mark (?, sometimes pronounced aloud as &ldquo;huh?&rdquo;) indicates a &ldquo;predicate&rdquo; method, one that can return either true or false.</p><h2 id=四种内部中断循环的方式>四种内部中断循环的方式</h2><ul><li><code>break</code></li><li><code>next</code> 等同与continue</li><li><code>redo</code> restarts the current iteration</li><li><code>return</code></li></ul><h2 id=迭代器-iterator>迭代器 iterator</h2><p>Ruby&rsquo;s String type has some useful iterators. <code>each_byte</code> is an iterator for each character in the string.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>irb<span style=color:#f92672>(</span>main<span style=color:#f92672>)</span>:001:0&gt; <span style=color:#e6db74>&#34;abc&#34;</span>.each_byte<span style=color:#f92672>{</span>|c| printf <span style=color:#e6db74>&#34;&lt;%c&gt;&#34;</span>, c<span style=color:#f92672>}</span>; print <span style=color:#e6db74>&#34;\n&#34;</span>
</span></span><span style=display:flex><span>&lt;a&gt;&lt;b&gt;&lt;c&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>&gt; nil
</span></span></code></pre></div><p>Another iterator of String is <code>each_line</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>irb<span style=color:#f92672>(</span>main<span style=color:#f92672>)</span>:002:0&gt; <span style=color:#e6db74>&#34;a\nb\nc\n&#34;</span>.each_line<span style=color:#f92672>{</span>|l| print l<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>a
</span></span><span style=display:flex><span>b
</span></span><span style=display:flex><span>c
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>&gt; <span style=color:#e6db74>&#34;a\nb\nc\n&#34;</span>
</span></span></code></pre></div><p>ruby的 <code>for in</code> 也是一种迭代。We can use a control structure <code>retry</code> in conjunction with an iterated loop, and it will retry the loop from the beginning.</p><h3 id=yield>yield</h3><p><code>yield</code> occurs sometimes in a definition of an iterator. <code>yield</code> moves control to the block of code that is passed to the iterator (this will be explored in more detail in the chapter about procedure objects). The following example defines an iterator repeat, which repeats a block of code the number of times specified in an argument.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>irb(main):<span style=color:#ae81ff>003</span>:<span style=color:#ae81ff>0</span><span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>repeat</span>(num)
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>004</span>:<span style=color:#ae81ff>1</span><span style=color:#f92672>&gt;</span>     <span style=color:#66d9ef>while</span> num <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>005</span>:<span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;</span>         <span style=color:#66d9ef>yield</span>
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>006</span>:<span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;</span>         num <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>007</span>:<span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;</span>     <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>00</span><span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>1</span><span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>:repeat</span>
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>00</span><span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>0</span><span style=color:#f92672>&gt;</span> repeat(<span style=color:#ae81ff>3</span>) { puts <span style=color:#e6db74>&#34;foo&#34;</span> }
</span></span><span style=display:flex><span>foo
</span></span><span style=display:flex><span>foo
</span></span><span style=display:flex><span>foo
</span></span><span style=display:flex><span><span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>nil</span>
</span></span></code></pre></div><h2 id=class>class</h2><h3 id=继承>继承</h3><p>继承的格式为:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Superclass</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>breathe</span>
</span></span><span style=display:flex><span>        puts <span style=color:#e6db74>&#34;inhale and exhale&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>identify</span>
</span></span><span style=display:flex><span>        puts <span style=color:#e6db74>&#34;I&#39;m super&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>speak</span>(word)
</span></span><span style=display:flex><span>        puts word
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Subclass</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>Superclass</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># code...</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><p>可在在子类中重新声明基类方法，也可以使用<code>super</code>关键字来扩展基类方法。<code>super</code>也允许我们传递参数给基类方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Subclass</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>Superclass</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>identify</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>
</span></span><span style=display:flex><span>        puts <span style=color:#e6db74>&#34;I&#39;m sub too&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>speak</span>(word)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>super</span>(<span style=color:#e6db74>&#34;this is from Superclass&#34;</span>)
</span></span><span style=display:flex><span>        puts <span style=color:#e6db74>&#34;now it&#39;s from Subclass: </span><span style=color:#e6db74>#{</span>word<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h3 id=初始化构造函数>初始化（构造函数）</h3><p><code>ruby</code>使用<code>initialize</code>关键字来实现构造函数的功能。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Fruit</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>initialize</span>( k<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;apple&#34;</span>)
</span></span><span style=display:flex><span>        @kind <span style=color:#f92672>=</span> k
</span></span><span style=display:flex><span>        @condition <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ripe&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>apple <span style=color:#f92672>=</span> <span style=color:#66d9ef>Fruit</span><span style=color:#f92672>.</span>new <span style=color:#e6db74>&#34;apple&#34;</span>
</span></span></code></pre></div><h2 id=variables>variables</h2><ul><li><code>[a-z] or _</code> 本地变量</li><li><code>$</code> 全局变量</li><li><code>@</code> 实例变量 instance variable</li><li><code>[A-Z]</code> 常量</li></ul><h3 id=全局变量>全局变量</h3><p>全局变量以 <code>$</code> 开头。初始化之前，全局变量的值为<code>nil</code>。可定义一段procedure来追踪全局变量。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>$x <span style=color:#75715e>#return nil</span>
</span></span><span style=display:flex><span>trace_var :$x, proc{puts <span style=color:#e6db74>&#34;$x is now </span><span style=color:#e6db74>#{</span>$x<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>}
</span></span><span style=display:flex><span>$x <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span> <span style=color:#75715e>#return $x is now 5</span>
</span></span></code></pre></div><p>一些特殊的变量（不一定是全局作用域）：</p><ul><li><code>$!</code> latest error message</li><li><code>$@</code> location of error</li><li><code>$_</code> 上一次由gets读入的字符串</li><li><code>$.</code> line number last read by interpreter</li><li><code>$&</code> string last matched by regexp</li><li><code>$~</code> the last regexp match, as an array of subexpressions</li><li><code>$n</code> the nth subexpression in the last match (same as $~[n])</li><li><code>$=</code> case-insensitivity flag</li><li><code>$/</code> input record separator</li><li><code>$\</code> output record separator</li><li><code>$0</code> the name of the ruby script file</li><li><code>$*</code> 命令行参数</li><li><code>$$</code> 当前解释器的进程id</li><li><code>$?</code> 上一次子进程的退出状态码</li></ul><h3 id=实例变量>实例变量</h3><p>An instance variable has a name beginning with <code>@</code>, and its scope is confined to whatever object <strong>self</strong> refers to. Two different objects, even if they belong to the same class, are allowed to have different values for their instance variables. From outside the object, instance variables <strong>cannot be altered or even observed</strong> (i.e., ruby&rsquo;s instance variables are never public) except by whatever methods are explicitly provided by the programmer. As with globals, instance variables have the nil value until they are initialized.</p><p>Instance variables do not need to be declared. This indicates a flexible object structure; in fact, each instance variable is dynamically appended to an object when it is first assigned.</p><h3 id=常量>常量</h3><p>常量名以大写字母开头。给常量重新赋值会得到警告。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>irb<span style=color:#f92672>(</span>main<span style=color:#f92672>)</span>:009:0&gt; Wzr<span style=color:#f92672>=</span>1222
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>&gt; <span style=color:#ae81ff>1222</span>
</span></span><span style=display:flex><span>irb<span style=color:#f92672>(</span>main<span style=color:#f92672>)</span>:010:0&gt; Wzr<span style=color:#f92672>=</span><span style=color:#ae81ff>1223</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>irb<span style=color:#f92672>)</span>:10: warning: already initialized constant Wzr
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>irb<span style=color:#f92672>)</span>:9: warning: previous definition of Wzr was here
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>&gt; <span style=color:#ae81ff>1223</span>
</span></span></code></pre></div><p>常量可以在类和模块中定义，并允许外部访问。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ConstClass</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>C1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ConstClass</span><span style=color:#f92672>::</span><span style=color:#66d9ef>C1</span> <span style=color:#75715e># return 120</span>
</span></span></code></pre></div><h2 id=访问器accessor>访问器(accessor)</h2><p>实例属性需要通过属性访问器访问。常规访问器有简化写法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Fruit</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>kind</span><span style=color:#f92672>=</span>(k)
</span></span><span style=display:flex><span>       @kind <span style=color:#f92672>=</span> k
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>kind</span>
</span></span><span style=display:flex><span>       @kind
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h3 id=inspect方法>inspect方法</h3><p>当创建一个对象时解释器会返回一些信息：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>irb(main):<span style=color:#ae81ff>00</span><span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>0</span><span style=color:#f92672>&gt;</span> apple <span style=color:#f92672>=</span> <span style=color:#66d9ef>Fruit</span><span style=color:#f92672>.</span>new
</span></span><span style=display:flex><span><span style=color:#f92672>=&gt;</span> <span style=color:#75715e>#&lt;Fruit:0x00000000a34f58&gt;</span>
</span></span><span style=display:flex><span>irb(main):<span style=color:#ae81ff>010</span>:<span style=color:#ae81ff>0</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>可以通过<code>inspect</code>关键字来改变这种默认行为。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Fruit</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inspect</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;a fruit is created&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><p><code>inspect</code>方法常用来调试，可通过下面两种方式显示调用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>p anObject
</span></span><span style=display:flex><span>puts anObject<span style=color:#f92672>.</span>inspect
</span></span></code></pre></div><h3 id=shortcuts>shortcuts</h3><p><code>Ruby</code>提供了访问器的一些简写形式：</p><table><thead><tr><th style=text-align:center>缩写</th><th style=text-align:center>效果</th></tr></thead><tbody><tr><td style=text-align:center>attr_reader :v</td><td style=text-align:center>def v; @v; end</td></tr><tr><td style=text-align:center>attr_writer :v</td><td style=text-align:center>def v=(value); @v=value; end</td></tr><tr><td style=text-align:center>attr_accessor :v</td><td style=text-align:center>attr_reader :v; attr_writer :v</td></tr><tr><td style=text-align:center>attr_accessor :v, :w</td><td style=text-align:center>attr_accessor :v; attr_accessor :w</td></tr></tbody></table><h2 id=注释>注释</h2><p>单行注释以<code>#</code>开头。
块注释可使用<code>=begin</code> <code>=end</code>来标记。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#75715e>=begin
</span></span></span><span style=display:flex><span><span style=color:#75715e>这是一段注释块。This is a comment block.
</span></span></span><span style=display:flex><span><span style=color:#75715e>Egg, I dreamed I was old.
</span></span></span><span style=display:flex><span><span style=color:#75715e>=end</span>
</span></span></code></pre></div><h2 id=dynamic-dispatch>Dynamic Dispatch</h2><h2 id=mixins>Mixins</h2><p>Ruby has no multiple inheritance. But it has mixins.</p><h3 id=lookup-rulres>Lookup rulres</h3><p>When looking for receiver obj&rsquo;s method m,</p><ul><li>look in obj&rsquo;s class</li><li>look in mixins the class includes(later includes shadow)</li><li>look in obj&rsquo;s superclass</li><li>look in mixins the superclass inculdes</li><li>&mldr;</li></ul></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="wzr",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#regular-expressions>regular expressions</a></li><li><a href=#和>!和?</a></li><li><a href=#四种内部中断循环的方式>四种内部中断循环的方式</a></li><li><a href=#迭代器-iterator>迭代器 iterator</a><ul><li><a href=#yield>yield</a></li></ul></li><li><a href=#class>class</a><ul><li><a href=#继承>继承</a></li><li><a href=#初始化构造函数>初始化（构造函数）</a></li></ul></li><li><a href=#variables>variables</a><ul><li><a href=#全局变量>全局变量</a></li><li><a href=#实例变量>实例变量</a></li><li><a href=#常量>常量</a></li></ul></li><li><a href=#访问器accessor>访问器(accessor)</a><ul><li><a href=#inspect方法>inspect方法</a></li><li><a href=#shortcuts>shortcuts</a></li></ul></li><li><a href=#注释>注释</a></li><li><a href=#dynamic-dispatch>Dynamic Dispatch</a></li><li><a href=#mixins>Mixins</a><ul><li><a href=#lookup-rulres>Lookup rulres</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&text=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&title=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&is_video=false&description=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0&body=Check out this article: https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&title=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&title=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&name=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0&description=regular%20expressions%20%3d~%e6%98%af%e7%94%a8%e4%ba%8e%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f%e7%9a%84%e5%8c%b9%e9%85%8d%e6%93%8d%e4%bd%9c%e7%ac%a6%e3%80%82%e8%bf%94%e5%9b%9e%e5%8c%b9%e9%85%8d%e5%88%b0%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e4%bd%8d%e7%bd%ae%e6%88%96nil%e3%80%82%0a%26%2334%3babcdef%26%2334%3b%20%3d~%20%2fd%2f%20%23%20return%203%20%26%2334%3baaaaaa%26%2334%3b%20%3d~%20%2fd%2f%20%23%20return%20nil%20%21%e5%92%8c%3f%20The%20exclamation%20point%20%28%21%2c%20sometimes%20pronounced%20aloud%20as%20%26ldquo%3bbang%21%26rdquo%3b%29%20indicates%20something%20potentially%20destructive%2c%20that%20is%20to%20say%2c%20something%20that%20can%20change%20the%20value%20of%20what%20it%20touches.%0aruby%26gt%3b%20s1%20%3d%20%26%2334%3bforth%26%2334%3b%20%26%2334%3bforth%26%2334%3b%20ruby%26gt%3b%20s1.chop%21%20%23%20This%20changes%20s1.%20%26%2334%3bfort%26%2334%3b%20ruby%26gt%3b%20s2%20%3d%20s1.chop%20%23%20This%20puts%20a%20changed%20copy%20in%20s2%2c%20%26%2334%3bfor%26%2334%3b%20ruby%26gt%3b%20s1%20%23%20." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.takuzen.me%2fposts%2f2016-12-08-ruby-notes%2f&t=ruby%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 呉</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script></html>